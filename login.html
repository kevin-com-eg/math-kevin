<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MathMaster - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-blue-600 to-purple-700 min-h-screen flex items-center justify-center p-4" style="font-family: 'Tajawal', sans-serif;">

  <!-- Ø¨Ø·Ø§Ù‚Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
  <div class="bg-white/95 backdrop-blur-sm rounded-3xl shadow-2xl p-8 w-full max-w-md">
    
    <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
    <div class="text-center mb-8">
      <div class="inline-block p-4 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl shadow-lg mb-4">
        <i class="fa-solid fa-calculator text-white text-4xl"></i>
      </div>
      <h1 class="text-3xl font-black text-gray-800 mb-2">MathMaster</h1>
      <p class="text-gray-600">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</p>
    </div>
    
    <!-- Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ -->
    <div id="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-xl mb-4 hidden">
      <span id="errorText"></span>
    </div>
    
    <!-- Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ (Ù„Ù„ØªØ¬Ø±Ø¨Ø©) -->
    <div id="successMessage" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-xl mb-4 hidden">
      ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...
    </div>
    
    <!-- Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div class="space-y-4">
      
      <div>
        <label class="block text-gray-700 font-bold mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
        <input id="email" type="email" placeholder="example@email.com" 
               class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none"
               dir="ltr">
      </div>
      
      <div>
        <label class="block text-gray-700 font-bold mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input id="password" type="password" placeholder="********" 
               class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none"
               dir="ltr">
      </div>
      
      <button id="loginBtn" 
              class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white p-3 rounded-xl font-bold text-lg hover:opacity-90 transition">
        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
      </button>
      
      <p class="text-center text-gray-600">
        Ù…Ø´ Ø¹Ø§ÙˆØ² Ø­Ø³Ø§Ø¨ØŸ 
        <a href="signup.html" class="text-blue-600 font-bold hover:text-blue-800">Ø³Ø¬Ù„ Ø§Ù„Ø¢Ù†</a>
      </p>
      
      <div class="text-center">
        <a href="index.html" class="text-gray-500 hover:text-gray-700 text-sm">
          Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </a>
      </div>
      
    </div>
  </div>

  <!-- Firebase Script -->
  <script type="module">
    console.log("âœ… Ø§Ù„ØµÙØ­Ø© ØªØ­Ù…Ù„Øª");
    
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } 
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    
    console.log("âœ… Firebase Ø§Ø³ØªÙˆØ±Ø¯Øª");

    const firebaseConfig = {
      apiKey: "AIzaSyByKmG7LLj9JMq2O94gS1-da2Kt8ghLzMo",
      authDomain: "math-e62c9.firebaseapp.com",
      projectId: "math-e62c9",
      storageBucket: "math-e62c9.appspot.com",
      messagingSenderId: "271507842148",
      appId: "1:271507842148:web:2907aad4caf67afd08ab71"
    };
    
    console.log("âœ… Config Ø¬Ø§Ù‡Ø²");

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    
    console.log("âœ… Firebase initialized");

    // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø©
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const loginBtn = document.getElementById('loginBtn');
    const errorDiv = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');
    const successDiv = document.getElementById('successMessage');

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù…ÙˆØ¬ÙˆØ¯Ø©
    console.log("ğŸ“Œ email:", emailInput);
    console.log("ğŸ“Œ password:", passwordInput);
    console.log("ğŸ“Œ loginBtn:", loginBtn);

    // ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    async function handleLogin() {
      console.log("ğŸŸ¢ ØªÙ… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±");
      
      const email = emailInput.value.trim();
      const password = passwordInput.value;
      
      console.log("ğŸ“§ Email:", email);
      console.log("ğŸ”‘ Password length:", password.length);

      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
      errorDiv.classList.add('hidden');
      successDiv.classList.add('hidden');
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
      if (!email || !password) {
        console.log("âŒ Ø­Ù‚ÙˆÙ„ ÙØ§Ø±ØºØ©");
        errorText.textContent = 'Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±';
        errorDiv.classList.remove('hidden');
        return;
      }
      
      try {
        console.log("ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...");
        loginBtn.disabled = true;
        loginBtn.innerHTML = '<i class="fa-solid fa-circle-notch animate-spin ml-2"></i> Ø¬Ø§Ø±ÙŠ...';
        
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        
        console.log("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:", userCredential.user.email);
        
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
        successDiv.classList.remove('hidden');
        
        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
        setTimeout(() => {
          window.location.href = 'dashboard.html';
        }, 2000);
        
      } catch (error) {
        console.error("âŒ Ø®Ø·Ø£:", error.code, error.message);
        
        // Ø±Ø³Ø§Ø¦Ù„ Ø®Ø·Ø£ Ù…ÙÙ‡ÙˆÙ…Ø©
        let message = 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
        switch (error.code) {
          case 'auth/user-not-found':
            message = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ';
            break;
          case 'auth/wrong-password':
            message = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
            break;
          case 'auth/invalid-email':
            message = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­';
            break;
          case 'auth/invalid-credential':
            message = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
            break;
          default:
            message = error.message;
        }
        
        errorText.textContent = 'âŒ ' + message;
        errorDiv.classList.remove('hidden');
        
      } finally {
        loginBtn.disabled = false;
        loginBtn.innerHTML = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
      }
    }

    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø« Ù„Ù„Ø²Ø±
    if (loginBtn) {
      loginBtn.addEventListener('click', handleLogin);
      console.log("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ø¯Ø« Ù„Ù„Ø²Ø±");
    } else {
      console.error("âŒ Ø§Ù„Ø²Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!");
    }

    // Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
    [emailInput, passwordInput].forEach(input => {
      if (input) {
        input.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') {
            handleLogin();
          }
        });
      }
    });

  </script>

  <style>
    .animate-spin {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
  </style>
</body>
</html>
