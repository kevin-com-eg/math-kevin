<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MathMaster - ููุญุฉ ุชุญูู ุงููุฏุฑุณ</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Tajawal', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e9eef5 100%);
    }
    
    /* ุจุทุงูุฉ ุงูุฏุฑุณ */
    .lesson-card {
      transition: all 0.3s ease;
      border-right: 4px solid transparent;
    }
    
    .lesson-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 30px -10px rgba(0, 100, 255, 0.15);
      border-right-color: #3b82f6;
    }
    
    /* ููุฏ ุงููุตูู */
    .access-code {
      font-family: 'Courier New', monospace;
      letter-spacing: 1px;
      background: #f3f4f6;
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 14px;
    }
    
    /* ุฒุฑ ุงูุฅุถุงูุฉ */
    .add-lesson-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: all 0.3s ease;
    }
    
    .add-lesson-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px -10px rgba(102, 126, 234, 0.5);
    }
    
    /* ุญุงูุฉ ุงูุชุญููู */
    .skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
    }
    
    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
  </style>
</head>
<body class="min-h-screen">

  <!-- ุงูุดุฑูุท ุงูุนููู -->
  <div class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center h-16">
        
        <!-- ุงูุดุนุงุฑ -->
        <div class="flex items-center gap-3">
          <i class="fa-solid fa-calculator text-blue-600 text-2xl"></i>
          <h1 class="text-xl font-bold text-blue-700 hidden sm:block">MathMaster</h1>
          <span class="bg-green-100 text-green-700 text-xs px-3 py-1 rounded-full mr-4">ูุฏุฑุณ</span>
        </div>
        
        <!-- ูุนูููุงุช ุงููุณุชุฎุฏู -->
        <div class="flex items-center gap-4">
          <button class="relative">
            <i class="fa-regular fa-bell text-gray-600 text-xl"></i>
            <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs w-4 h-4 rounded-full flex items-center justify-center">3</span>
          </button>
          
          <div class="flex items-center gap-2">
            <div class="bg-gradient-to-r from-blue-600 to-purple-600 w-10 h-10 rounded-full flex items-center justify-center text-white font-bold">
              ุฏ
            </div>
            <div class="hidden md:block">
              <p class="font-semibold" id="teacherName">ุฏูุชูุฑ/ ุฃุญูุฏ</p>
              <p class="text-xs text-gray-500">ูุฏุฑุณ ุฑูุงุถูุงุช</p>
            </div>
          </div>
          
          <button id="logoutBtn" class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-600 transition">
            <i class="fa-regular fa-arrow-right-from-bracket ml-1"></i>
            ุฎุฑูุฌ
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
  <div class="container mx-auto px-4 py-8">
    
    <!-- ===== ูุณู ุงูุชุฑุญูุจ ===== -->
    <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-3xl p-8 text-white mb-8">
      <h2 class="text-3xl font-black mb-2">ูุฑุญุจุงู ุฏูุชูุฑ/ ุฃุญูุฏ! ๐จโ๐ซ</h2>
      <p class="text-white/80">ูู ููุง ุชูุฏุฑ ุชุชุญูู ูู ูู ุงูุฏุฑูุณ ูุงูุงูุชุญุงูุงุช ุจุชุงุนุชู</p>
    </div>
    
    <!-- ===== ุฒุฑ ุฅูุดุงุก ุฏุฑุณ ุฌุฏูุฏ (ูุงุถุญ ููุจูุฑ) ===== -->
    <div class="text-center mb-8">
      <button onclick="window.location.href='create-lesson-exam.html'" 
              class="add-lesson-btn text-white px-8 py-4 rounded-2xl font-bold text-xl shadow-lg inline-flex items-center gap-3">
        <i class="fa-regular fa-plus-circle"></i>
        ุฅูุดุงุก ุฏุฑุณ ุฌุฏูุฏ + ุงูุชุญุงู
      </button>
      <p class="text-gray-500 mt-2 text-sm">ุงุถุบุท ููุง ูุฅูุดุงุก ุฏุฑุณ ุฌุฏูุฏ ูุชุญุฏูุฏ ููุฏ ูุตูู ููุทูุงุจ</p>
    </div>
    
    <!-- ===== ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ ===== -->
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
      
      <div class="bg-white rounded-2xl shadow p-6">
        <div class="flex items-center gap-4">
          <div class="bg-blue-100 p-3 rounded-xl">
            <i class="fa-solid fa-book-open text-blue-600 text-2xl"></i>
          </div>
          <div>
            <p class="text-gray-500 text-sm">ุฅุฌูุงูู ุงูุฏุฑูุณ</p>
            <h3 class="text-3xl font-black text-gray-800" id="totalLessons">12</h3>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-2xl shadow p-6">
        <div class="flex items-center gap-4">
          <div class="bg-green-100 p-3 rounded-xl">
            <i class="fa-solid fa-users text-green-600 text-2xl"></i>
          </div>
          <div>
            <p class="text-gray-500 text-sm">ุฅุฌูุงูู ุงูุทูุงุจ</p>
            <h3 class="text-3xl font-black text-gray-800" id="totalStudents">345</h3>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-2xl shadow p-6">
        <div class="flex items-center gap-4">
          <div class="bg-yellow-100 p-3 rounded-xl">
            <i class="fa-solid fa-pen-to-square text-yellow-600 text-2xl"></i>
          </div>
          <div>
            <p class="text-gray-500 text-sm">ุงูุชุญุงูุงุช ูุตุญุญุฉ</p>
            <h3 class="text-3xl font-black text-gray-800" id="totalExams">89</h3>
          </div>
        </div>
      </div>
      
    </div>
    
    <!-- ===== ูุณู ุงูุฏุฑูุณ ุงูููุดูุฑุฉ ===== -->
    <div class="bg-white rounded-3xl shadow p-6">
      
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold flex items-center gap-2">
          <i class="fa-solid fa-book-open text-blue-600"></i>
          ุงูุฏุฑูุณ ุงููู ุฃูุดุฃุชูุง
        </h3>
        
        <div class="flex gap-2">
          <select class="border border-gray-200 rounded-lg px-3 py-2 text-sm">
            <option>ูู ุงูุฏุฑูุณ</option>
            <option>ููุดูุฑ</option>
            <option>ูุณูุฏุฉ</option>
          </select>
          
          <button class="border border-gray-200 rounded-lg px-3 py-2 text-sm hover:bg-gray-50">
            <i class="fa-regular fa-arrow-rotate-right"></i>
          </button>
        </div>
      </div>
      
      <!-- ุญุงูุฉ ุนุฏู ูุฌูุฏ ุฏุฑูุณ -->
      <div id="noLessonsMessage" class="text-center py-16 hidden">
        <div class="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fa-regular fa-book-open text-gray-400 text-4xl"></i>
        </div>
        <h4 class="text-xl font-bold text-gray-700 mb-2">ูููุด ุฏุฑูุณ ุญุชู ุงูุขู</h4>
        <p class="text-gray-500 mb-6">ุฃูู ุฏุฑุณ ูุณู ูุชุนููุด. ุฅุถุบุท ุนูู ุงูุฒุฑ ุงูุฃุฒุฑู ุนุดุงู ุชุจุฏุฃ</p>
        <button onclick="window.location.href='create-lesson-exam.html'" 
                class="bg-blue-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-blue-700 transition">
          <i class="fa-regular fa-plus-circle ml-2"></i>
          ุฃูุดุฆ ุฃูู ุฏุฑุณ
        </button>
      </div>
      
      <!-- ุดุจูุฉ ุงูุฏุฑูุณ (ุชุธูุฑ ูู ููู ุฏุฑูุณ) -->
      <div id="lessonsGrid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
        
        <!-- ุฏุฑุณ 1 (ูุซุงู) -->
        <div class="lesson-card bg-gray-50 rounded-xl p-4 border border-gray-200">
          
          <div class="flex justify-between items-start mb-3">
            <span class="bg-blue-100 text-blue-700 text-xs px-3 py-1 rounded-full">
              <i class="fa-regular fa-play-circle ml-1"></i>
              ุฏุฑุณ ูก
            </span>
            <div class="flex gap-1">
              <button class="w-8 h-8 bg-white rounded-lg hover:bg-gray-100 transition">
                <i class="fa-regular fa-pen text-gray-600"></i>
              </button>
              <button class="w-8 h-8 bg-white rounded-lg hover:bg-red-100 transition">
                <i class="fa-regular fa-trash-can text-red-500"></i>
              </button>
            </div>
          </div>
          
          <h4 class="font-bold text-lg mb-2">ุงูุฌุจุฑ - ุงููุนุงุฏูุงุช ุงูุฎุทูุฉ</h4>
          
          <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
            <span><i class="fa-regular fa-clock ml-1"></i> ูคูฅ ุฏ</span>
            <span>โข</span>
            <span><i class="fa-regular fa-file-video ml-1"></i> ูฃ ููุฏูููุงุช</span>
          </div>
          
          <!-- ููุฏ ุงููุตูู (ููู) -->
          <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-2 mb-3">
            <p class="text-xs text-yellow-700 mb-1">๐ ููุฏ ูุตูู ุงูุทูุงุจ</p>
            <div class="flex items-center justify-between">
              <span class="access-code font-bold text-blue-700">MATH-2024-001</span>
              <button onclick="copyCode('MATH-2024-001')" class="text-blue-600 hover:text-blue-800">
                <i class="fa-regular fa-copy"></i>
              </button>
            </div>
          </div>
          
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-500">
              <i class="fa-regular fa-users ml-1"></i>
              ูขูค ุทุงูุจ
            </span>
            <span class="text-green-600">โ ููุดูุฑ</span>
          </div>
          
        </div>
        
        <!-- ุฏุฑุณ 2 (ูุซุงู) -->
        <div class="lesson-card bg-gray-50 rounded-xl p-4 border border-gray-200">
          
          <div class="flex justify-between items-start mb-3">
            <span class="bg-purple-100 text-purple-700 text-xs px-3 py-1 rounded-full">
              <i class="fa-regular fa-star ml-1"></i>
              ุฏุฑุณ ูข
            </span>
            <div class="flex gap-1">
              <button class="w-8 h-8 bg-white rounded-lg hover:bg-gray-100 transition">
                <i class="fa-regular fa-pen text-gray-600"></i>
              </button>
              <button class="w-8 h-8 bg-white rounded-lg hover:bg-red-100 transition">
                <i class="fa-regular fa-trash-can text-red-500"></i>
              </button>
            </div>
          </div>
          
          <h4 class="font-bold text-lg mb-2">ุงูููุฏุณุฉ - ุงููุซูุซุงุช</h4>
          
          <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
            <span><i class="fa-regular fa-clock ml-1"></i> ูฆู ุฏ</span>
            <span>โข</span>
            <span><i class="fa-regular fa-file-video ml-1"></i> ูค ููุฏูููุงุช</span>
          </div>
          
          <!-- ููุฏ ุงููุตูู -->
          <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-2 mb-3">
            <p class="text-xs text-yellow-700 mb-1">๐ ููุฏ ูุตูู ุงูุทูุงุจ</p>
            <div class="flex items-center justify-between">
              <span class="access-code font-bold text-blue-700">MATH-2024-002</span>
              <button onclick="copyCode('MATH-2024-002')" class="text-blue-600 hover:text-blue-800">
                <i class="fa-regular fa-copy"></i>
              </button>
            </div>
          </div>
          
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-500">
              <i class="fa-regular fa-users ml-1"></i>
              ูกูจ ุทุงูุจ
            </span>
            <span class="text-green-600">โ ููุดูุฑ</span>
          </div>
          
        </div>
        
        <!-- ุฏุฑุณ 3 (ูุณูุฏุฉ) -->
        <div class="lesson-card bg-gray-50 rounded-xl p-4 border border-gray-200 opacity-80">
          
          <div class="flex justify-between items-start mb-3">
            <span class="bg-gray-200 text-gray-600 text-xs px-3 py-1 rounded-full">
              <i class="fa-regular fa-clock ml-1"></i>
              ูุณูุฏุฉ
            </span>
            <div class="flex gap-1">
              <button class="w-8 h-8 bg-white rounded-lg hover:bg-gray-100 transition">
                <i class="fa-regular fa-pen text-gray-600"></i>
              </button>
              <button class="w-8 h-8 bg-white rounded-lg hover:bg-red-100 transition">
                <i class="fa-regular fa-trash-can text-red-500"></i>
              </button>
            </div>
          </div>
          
          <h4 class="font-bold text-lg mb-2">ุงูุชูุงุถู - ุงููุดุชูุงุช (ุฌุงุฑู ุงูุชุญุถูุฑ)</h4>
          
          <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
            <span><i class="fa-regular fa-clock ml-1"></i> ูฉู ุฏ</span>
            <span>โข</span>
            <span><i class="fa-regular fa-file-video ml-1"></i> ูฆ ููุฏูููุงุช</span>
          </div>
          
          <!-- ููุฏ ุงููุตูู ูุณู ูุชุญุฏุฏุด -->
          <div class="bg-gray-100 border border-gray-200 rounded-lg p-2 mb-3">
            <p class="text-xs text-gray-500 mb-1">โณ ูุณู ูุชุญุฏุฏุด</p>
            <div class="flex items-center justify-between">
              <span class="access-code text-gray-400">---</span>
              <button disabled class="text-gray-400">
                <i class="fa-regular fa-copy"></i>
              </button>
            </div>
          </div>
          
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-500">
              <i class="fa-regular fa-users ml-1"></i>
              ู ุทุงูุจ
            </span>
            <span class="text-yellow-600">โณ ูุณูุฏุฉ</span>
          </div>
          
        </div>
        
      </div>
      
      <!-- ุฑุณุงูุฉ ูู ูููุด ุฏุฑูุณ (ููุฎูููุง ุฏูููุชู ุนุดุงู ููู ุฏุฑูุณ) -->
      <!-- <div id="noLessonsMessage" class="hidden">...</div> -->
      
    </div>
    
    <!-- ===== ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ ููุฏุฑูุณ ===== -->
    <div class="grid md:grid-cols-2 gap-4 mt-8">
      
      <div class="bg-white rounded-2xl shadow p-6">
        <h4 class="font-bold mb-4 flex items-center gap-2">
          <i class="fa-regular fa-chart-pie text-blue-600"></i>
          ุชูุฒูุน ุงูุฏุฑูุณ
        </h4>
        <div class="space-y-3">
          <div>
            <div class="flex justify-between text-sm mb-1">
              <span>ุงูุตู ุงูุฃูู ุงูุซุงููู</span>
              <span class="font-bold">ูค ุฏุฑูุณ</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-blue-600 h-2 rounded-full" style="width: 40%;"></div>
            </div>
          </div>
          <div>
            <div class="flex justify-between text-sm mb-1">
              <span>ุงูุตู ุงูุซุงูู ุงูุซุงููู</span>
              <span class="font-bold">ูฃ ุฏุฑูุณ</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-purple-600 h-2 rounded-full" style="width: 30%;"></div>
            </div>
          </div>
          <div>
            <div class="flex justify-between text-sm mb-1">
              <span>ุงูุตู ุงูุซุงูุซ ุงูุซุงููู</span>
              <span class="font-bold">ูฅ ุฏุฑูุณ</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-green-600 h-2 rounded-full" style="width: 50%;"></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bg-white rounded-2xl shadow p-6">
        <h4 class="font-bold mb-4 flex items-center gap-2">
          <i class="fa-regular fa-clock text-blue-600"></i>
          ุขุฎุฑ ุงูุฏุฑูุณ ุฅุถุงูุฉ
        </h4>
        <div class="space-y-3">
          <div class="flex items-center gap-3">
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
            <span class="flex-1">ุงููุนุงุฏูุงุช ุงูุฎุทูุฉ</span>
            <span class="text-sm text-gray-500">ููุฐ ููููู</span>
          </div>
          <div class="flex items-center gap-3">
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
            <span class="flex-1">ูุธุฑูุงุช ุงููุซูุซุงุช</span>
            <span class="text-sm text-gray-500">ููุฐ ูฅ ุฃูุงู</span>
          </div>
          <div class="flex items-center gap-3">
            <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
            <span class="flex-1">ุงููุดุชูุงุช (ูุณูุฏุฉ)</span>
            <span class="text-sm text-gray-500">ููุฐ ุฃุณุจูุน</span>
          </div>
        </div>
      </div>
      
    </div>
    
  </div>
  
  <!-- Firebase Script -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } 
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, collection, query, where, getDocs } 
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
  
    const firebaseConfig = {
      apiKey: "AIzaSyByKmG7LLj9JMq2O94gS1-da2Kt8ghLzMo",
      authDomain: "math-e62c9.firebaseapp.com",
      projectId: "math-e62c9",
      storageBucket: "math-e62c9.appspot.com",
      messagingSenderId: "271507842148",
      appId: "1:271507842148:web:2907aad4caf67afd08ab71"
    };
  
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
  
    // ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        // ูู ูุด ูุณุฌูุ ุญูู ูุตูุญุฉ login
        window.location.href = "login.html";
      } else {
        console.log("ูุณุชุฎุฏู ูุณุฌู:", user.uid);
        
        // ุฌูุจ ุงูุฏุฑูุณ ุงูุฎุงุตุฉ ุจุงููุฏุฑุณ ููุท
        await loadTeacherLessons(user.uid);
      }
    });
  
    // ุชุญููู ุงูุฏุฑูุณ ุงููู ุงููุฏุฑุณ ุนูููุง
    async function loadTeacherLessons(teacherId) {
      try {
        console.log("ุฌูุจ ุฏุฑูุณ ุงููุฏุฑุณ:", teacherId);
        
        // Query ูู Firebase (ูููุนููุง ุจุนุฏ ูุง ูุถุจุท Firestore)
        // const lessonsRef = collection(db, 'lessons');
        // const q = query(lessonsRef, where('teacherId', '==', teacherId));
        // const querySnapshot = await getDocs(q);
        
        // ูุคูุชุงู ุจูุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
        const noLessonsDiv = document.getElementById('noLessonsMessage');
        const lessonsGrid = document.getElementById('lessonsGrid');
        
        // ูู ูููุด ุฏุฑูุณ (ูุซูุงู ุฃูู ูุฑุฉ)
        const hasLessons = true; // ุบูุฑูุง ุญุณุจ ุงูุจูุงูุงุช
        
        if (!hasLessons) {
          noLessonsDiv.classList.remove('hidden');
          lessonsGrid.classList.add('hidden');
        } else {
          noLessonsDiv.classList.add('hidden');
          lessonsGrid.classList.remove('hidden');
        }
        
      } catch (error) {
        console.error("ุฎุทุฃ ูู ุฌูุจ ุงูุฏุฑูุณ:", error);
      }
    }
  
    // ุชุณุฌูู ุงูุฎุฑูุฌ
    document.getElementById('logoutBtn').addEventListener('click', async () => {
      try {
        await signOut(auth);
        window.location.href = 'login.html';
      } catch (error) {
        alert('ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุณุฌูู ุงูุฎุฑูุฌ');
      }
    });
    
  </script>
  
  <script>
    // ูุณุฎ ุงูููุฏ
    function copyCode(code) {
      navigator.clipboard.writeText(code).then(() => {
        alert('โ ุชู ูุณุฎ ุงูููุฏ: ' + code);
      }).catch(() => {
        alert('โ ูุดู ุงููุณุฎ');
      });
    }
    
    // ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุชุฌุฑูุจูุฉ
    setTimeout(() => {
      document.getElementById('totalLessons').textContent = '12';
      document.getElementById('totalStudents').textContent = '345';
      document.getElementById('totalExams').textContent = '89';
    }, 500);
  </script>
  
</body>
</html>
